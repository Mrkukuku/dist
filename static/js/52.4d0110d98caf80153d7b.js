webpackJsonp([52],{"0ccU":function(t,e){},M1xS:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("inaZ"),n={data:function(){return{tableData:[],pageNum:1,pageSize:10,total:0,startTime:"",endTime:"",unitId:"",pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()},shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick:function(t){var e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}}]},ruleForm:{name:"",unitId:"",endTime:"",chargeId:"",type:"1",address:"",content:"",planPersonNum:""},imgUrl:""}},components:{pagination:a("MCsY").a},methods:{searchreset:function(){this.startTime="",this.endTime="",this.getData()},pageChange:function(t){this.pageNum=t.page_index,this.pageSize=t.page_limit,this.getData()},searchData:function(){this.pageNum=1,this.$refs.paginationChild.changePageNum(this.pageNum),this.getData()},getData:function(){var t=new Date(this.startTime),e=new Date(this.endTime);if(""==this.startTime&&""==this.endTime||t.getTime()<=e.getTime()){var a=this;this.axios({url:"/api/admin/complaints/page",method:"post",data:{pageNum:this.pageNum,pageSize:this.pageSize,unitId:this.unitId,startTime:this.startTime,endTime:this.endTime}}).then(function(t){if(0==t.data.code){for(var e in a.tableData=t.data.list,a.tableData)a.tableData[e].createdTime=a.$moment(a.tableData[e].createdTime).format("YYYY-MM-DD");a.total=t.data.total}else a.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})}else this.$message.error("开始时间不能小于结束时间")},haveEQ:function(){var t=this;this.axios({url:"/api/admin/complaints/qr",method:"post",data:{id:this.unitId}}).then(function(e){if(0==e.data.code){t.imgUrl=e.data.data;var a=new XMLHttpRequest;a.open("GET",t.imgUrl,!0),a.responseType="blob",a.onload=function(){Object(i.a)(a.response,"图片","text/plain")},a.send()}else _this.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})},print:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=void 0!==window.screenLeft?window.screenLeft:screen.left,n=void 0!==window.screenTop?window.screenTop:screen.top,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,r=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,s=o/2-(e=0==+e?o:e)/2+i,l=r/2-(a=0==+a?r:a)/2+n,d=window.open("","打印","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=yes, copyhistory=no, width="+e+", height="+a+", top="+l+", left="+s);return d.document.write(t+"<style type='text/css'>table.gridtable {font-family: verdana,arial,sans-serif;font-size:11px;color:#333333;border-width: 1px;border-color: #666666;border-collapse: collapse;}table.gridtable th {border-width: 1px;padding: 8px;border-style: solid;border-color: #666666;background-color: #dedede;}table.gridtable td {border-width: 1px;padding: 8px;border-style: solid;border-color: #666666;background-color: #ffffff;}</style>"),d.focus(),d.document.close(),d.print(),d}},mounted:function(){this.unitId=sessionStorage.getItem("unitId"),this.getData()}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"allcontent",attrs:{id:"complaintsReportList"}},[a("div",{staticStyle:{display:"none"},attrs:{id:"erwei"}},[a("img",{attrs:{src:t.imgUrl,alt:"二维码"}})]),t._v(" "),a("el-col",{staticStyle:{height:"100%","padding-left":"10px"},attrs:{span:24}},[a("div",{staticClass:"top"},[t._v("\n            选择时间:"),a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"开始日期"},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v("\n                - "),a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"结束日期"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.searchData}},[t._v("查询")]),t._v(" "),a("el-button",{on:{click:t.searchreset}},[t._v("重置")]),t._v(" "),a("el-button",{attrs:{type:"success"},on:{click:t.haveEQ}},[t._v("下载二维码")]),t._v(" "),a("div",{staticStyle:{display:"none"},attrs:{id:"erwei"}},[a("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center",height:"520px"}},[a("img",{attrs:{src:t.imgUrl,alt:"二维码"}})])])],1),t._v(" "),a("div",{staticClass:"bottom"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"投诉人",width:"130"}}),t._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"电话",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"场所类型",width:"250"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"地址",width:"250"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createdTime",label:"时间",width:"95"}}),t._v(" "),a("el-table-column",{attrs:{prop:"content",label:"投诉内容"}})],1),t._v(" "),a("div",{staticClass:"page_all"},[a("pagination",{ref:"paginationChild",attrs:{total:t.total},on:{pageChange:t.pageChange}})],1)],1)])],1)},staticRenderFns:[]};var r=a("VU/8")(n,o,!1,function(t){a("0ccU")},"data-v-0b068fb2",null);e.default=r.exports}});