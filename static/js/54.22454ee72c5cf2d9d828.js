webpackJsonp([54],{Q14W:function(t,e){},y5Xq:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("g5qz"),n=a("MCsY"),s={mixins:[i.a],components:{pagination:n.a},data:function(){var t=this;return{radio:1,module:"inspectionRecord",userType:"",unitId:"",currentPage:1,rows:10,total:0,tableData:[],startTime:"",endTime:"",expireTimeOptionStart:{disabledDate:function(e){var a=t.endTime;return a&&e.getTime()>new Date(a).getTime()||e.getTime()>Date.now()}},expireTimeOptionEnd:{disabledDate:function(e){var a=t.startTime;return a&&e.getTime()<new Date(a).getTime()||e.getTime()>Date.now()}},type:"",typeList:[],type1:"",typeList1:[{id:0,name:"正常"},{id:1,name:"异常"}],department:"",checkList:[],pollingVisible:!1,pollingDetail:{}}},methods:{exportPolling:function(){this.$post("/api/admin/device/inspection/info/excel",{startTime:this.startTime,endTime:this.endTime,unitId:this.unitId,type:4,isExpires:0}).then(function(t){t.data&&(location.href=t.data)})},editData:function(t){var e=this;this.$post("/api/admin/device/inspection/single",{id:t}).then(function(t){e.pollingVisible=!0,e.pollingDetail=t.data})},seach:function(){this.currentPage=1,this.$refs.paginations.changePageNum(1),this.getDatas()},getDatas:function(){var t=this;this.axios({url:"/api/admin/device/inspection/list",method:"post",data:{startTime:this.startTime,endTime:this.endTime,unitId:this.unitId,pageSize:this.rows,pageNum:this.currentPage,type:4,isExpires:0}}).then(function(e){0==e.data.code?(t.tableData=e.data.data.startPage.list,t.total=e.data.data.startPage.total,t.checkList=e.data.data.deviceTypeList):t.$alert(e.data.msg)})},getData:function(){},handleReset:function(){this.startTime="",this.endTime="",this.type="",this.type1="",this.department="",this.currentPage=1,this.$refs.paginations.changePageNum(1),this.getDatas()},pageChange:function(t){this.currentPage=t.page_index,this.rows=t.page_limit,this.getDatas()},renderContent:function(t,e){var a=e.node;return t("span",[t("i",{class:e.data.icon})," ",t("span",[a.label])])},handleNodeClick:function(t){this.unitId=t.id,this.getDatas()}},mounted:function(){this.userType=sessionStorage.getItem("userTypes"),this.unitId=Number(sessionStorage.getItem("unitId")),3==this.userType&&this.getDatas()}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"allcontent",attrs:{id:"spot_check"}},[a("el-row",{staticStyle:{height:"100%"}},[3!=t.userType?a("el-col",{staticClass:"tree_box",attrs:{span:4}},[a("div",[a("el-input",{staticClass:"filter_text",attrs:{placeholder:"输入关键字进行过滤"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),a("el-tree",{ref:"tree",attrs:{data:t.Treedata,props:t.defaultProps,"render-content":t.renderContent,"highlight-current":"","filter-node-method":t.filterNode},on:{"node-click":t.handleNodeClick}})],1)]):t._e(),t._v(" "),a("el-col",{staticStyle:{height:"100%"},attrs:{span:3==t.userType?24:20}},[a("div",{staticClass:"top"},[a("div",[t._v("\r\n                  \r\n                时间筛选："),a("el-date-picker",{staticClass:"picker",attrs:{type:"date",placeholder:"开始日期","value-format":"yyyy-MM-dd","picker-options":t.expireTimeOptionStart},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v(" -\r\n                "),a("el-date-picker",{staticClass:"picker",attrs:{type:"date","picker-options":t.expireTimeOptionEnd,placeholder:"结束日期","value-format":"yyyy-MM-dd"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.seach}},[t._v(" 查询")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.exportPolling}},[t._v("导出")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleReset}},[t._v("重置")])],1)]),t._v(" "),a("div",{staticStyle:{"margin-top":"10px",height:"88%",position:"relative"}},[a("el-table",{attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"updateTime",label:"日期",align:"center",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"设备名称",align:"center",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"设备地址",align:"center",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"泵",align:"center",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                      "+t._s(e.row.checkList[0].status)+"\r\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"控制柜",align:"center",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                      "+t._s(e.row.checkList[1].status)+"\r\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"管网",align:"center",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                      "+t._s(e.row.checkList[2].status)+"\r\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"消防电话",align:"center",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                      "+t._s(e.row.checkList[3].status)+"\r\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"泵房环境",align:"center",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                      "+t._s(e.row.checkList[4].status)+"\r\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"水箱",align:"center",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                      "+t._s(e.row.checkList[5].status)+"\r\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"水力警铃",align:"center",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                      "+t._s(e.row.checkList[6].status)+"\r\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"水位",align:"center",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                      "+t._s(e.row.checkList[7]&&e.row.checkList[7].status)+"\r\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"uname",label:"检查人",align:"center",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"time",label:"详情",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.editData(e.row.id)}}},[t._v("查看")])]}}])})],1),t._v(" "),a("div",{staticClass:"page",staticStyle:{position:"absolute",bottom:"0"}},[a("pagination",{ref:"paginations",attrs:{total:t.total},on:{pageChange:t.pageChange}})],1)],1)])],1),t._v(" "),a("el-dialog",{attrs:{width:"475px",title:"巡检任务详情",visible:t.pollingVisible,id:"polling"},on:{"update:visible":function(e){t.pollingVisible=e}}},[a("div",{staticClass:"content"},[a("div",[a("div",{staticClass:"title"},[t._v("巡检记录")]),t._v(" "),a("div",{staticClass:"descript"},[a("div",{staticClass:"title1"},[t._v("检查情况")]),t._v(" "),a("div",{staticClass:"textarea"},[t._v("\r\n                           "+t._s(t.pollingDetail.content)+"\r\n                        ")])]),t._v(" "),a("div",{staticClass:"checkImage"},[a("div",{staticClass:"title1"},[t._v("\r\n                            巡查照片\r\n                        ")]),t._v(" "),a("div",{staticClass:"imageList"},t._l(t.pollingDetail.checkImages,function(t,e){return a("img",{key:e,staticClass:"img",attrs:{src:t,alt:""}})}),0)])]),t._v(" "),a("div",{staticClass:"sign_head"},[t._v("\r\n                    签名\r\n                ")]),t._v(" "),a("div",{staticClass:"sign"},[a("img",{attrs:{src:t.pollingDetail.watchkeeperImgUrl,alt:""}})])])])],1)},staticRenderFns:[]};var l=a("VU/8")(s,r,!1,function(t){a("Q14W")},null,null);e.default=l.exports}});