webpackJsonp([24],{CoSj:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("woOf"),o=a.n(i),l=a("g5qz"),n=a("MCsY"),r={mixins:[l.a],components:{pagination:n.a},data:function(){return{module:"equipment",deviceName:"",upload:"",currentPage:1,rows:10,total:1,deviceId:null,ruleForm:{id:null,deviceName:"",deviceModel:"",intelligentFireSystemDesc:"",deviceTypeDesc:""},informationData:[],informationDataForm:{id:null,fileDesc:"",filePath:"",deviceId:null,fileName:""},rulesinformationData:{filePath:[{required:!0,message:"请先上传资料",trigger:"blur"}]}}},methods:{beforeUpload:function(t){this.upload=t.raw},submitUpload:function(){var t=this,e=new FormData;e.append("file",this.upload),e.append("fileType",1),this.axios({url:"/api/admin/file/upload",method:"post",data:e}).then(function(e){0==e.data.code?(t.informationDataForm.filePath=e.data.data.fileUrl,t.informationDataForm.fileName=e.data.data.fileName,t.$alert("上传成功","提示",{confirmButtonText:"OK"})):t.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})},dataSubmit:function(t){var e=this;e.informationDataForm.deviceId=this.deviceId,this.$refs[t].validate(function(t){t&&e.axios({url:"/api/admin/device/lib/file.add",method:"post",data:e.informationDataForm}).then(function(t){0==t.data.code?e.$alert("添加成功","提示",{confirmButtonText:"OK",callback:function(){e.dataReset(),e.dataList(e.deviceId)}}):e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})})},dataList:function(t){var e=this;this.axios({url:"/api/admin/device/lib/file.list",method:"post",data:{id:t}}).then(function(t){0==t.data.code?e.informationData=t.data.data:e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})},dataReset:function(){o()(this.$data.informationDataForm,this.$options.data().informationDataForm),this.$refs.upload.clearFiles()},searchdata:function(){var t=this;this.currentPage=1,this.$refs.paginationChild.changePageNum(this.currentPage),this.axios({url:"/api/admin/device/lib/list",method:"post",data:{deviceName:this.deviceName,unitId:sessionStorage.getItem("unitId"),pageNum:this.currentPage,pageSize:this.rows}}).then(function(e){0==e.data.code?(t.tableData=e.data.list,t.total=e.data.total,t.currentPage=e.data.pageNum):t.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})},searchReset:function(){this.deviceName="",this.searchdata()},handleDetail:function(t){this.informationDataForm.deviceId=t,this.deviceId=t,this.dataList(t),this.dialogVisible=!0},dataDelete:function(t){var e=this,a=this;this.$confirm("你确定要删除吗").then(function(){e.axios({url:"/api/admin/device/lib/file.delete",method:"post",data:{id:t}}).then(function(t){0==t.data.code?a.$alert("删除成功","提示",{confirmButtonText:"OK",callback:function(){a.dataList(a.deviceId)}}):a.$alert(t.data.msg,"提示",{confirmButtonText:"OK"}),a.getData()})})},pageChange:function(t){this.currentPage=t.page_index,this.rows=t.page_limit,this.getData()}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"allcontent",attrs:{id:"equipmentdatabase"}},[a("div",{staticClass:"top"},[a("div",[t._v("\n               设备名称:\n            "),a("el-input",{model:{value:t.deviceName,callback:function(e){t.deviceName=e},expression:"deviceName"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.searchdata}},[t._v("查询")]),t._v(" "),a("el-button",{on:{click:t.searchReset}},[t._v("重置")])],1)]),t._v(" "),a("div",{staticStyle:{"margin-top":"10px",height:"88%",position:"relative"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"deviceName",label:"设备名称",width:"230"}}),t._v(" "),a("el-table-column",{attrs:{prop:"deviceModel",label:"型号",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"intelligentFireSystemDesc",label:"隶属系统",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"deviceTypeDesc",label:"设备类型",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"el-icon-bank-card",attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.handleDetail(e.row.id)}}},[t._v("设备资料管理")])]}}])})],1),t._v(" "),a("div",{staticStyle:{position:"absolute",bottom:"0"}},[a("pagination",{ref:"paginationChild",attrs:{total:t.total},on:{pageChange:t.pageChange}})],1)],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{title:"添加修改数据",visible:t.dialogVisible,width:"50%","close-on-click-modal":!1,"before-close":t.closedialog},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("fieldset",[a("legend",{staticStyle:{"font-size":"19px"}},[t._v("资料上传")]),t._v(" "),a("el-form",{ref:"informationDataForm",staticClass:"demo-ruleForm",attrs:{model:t.informationDataForm,rules:t.rulesinformationData,data:t.informationDataForm,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"设备名称",prop:"filePath"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","on-change":t.beforeUpload,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("请选择文件")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("上传文件")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"资料描述",prop:"fileDesc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.informationDataForm.fileDesc,callback:function(e){t.$set(t.informationDataForm,"fileDesc",e)},expression:"informationDataForm.fileDesc"}})],1),t._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:function(e){return t.dataSubmit("informationDataForm")}}},[t._v("立即提交")]),t._v(" "),a("el-button",{on:{click:t.closedialog}},[t._v("取 消")])],1)],1)],1),t._v(" "),a("div",{staticStyle:{"margin-top":"10%"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.informationData,border:""}},[a("el-table-column",{attrs:{prop:"fileName",label:"资料名称",width:"230"}}),t._v(" "),a("el-table-column",{attrs:{prop:"fileDesc",label:"资料描述",width:"500"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"el-icon-delete",attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.dataDelete(e.row.id)}}},[t._v("删除")])]}}])})],1)],1)])],1)},staticRenderFns:[]};var d=a("VU/8")(r,s,!1,function(t){a("EcyN")},null,null);e.default=d.exports},EcyN:function(t,e){}});