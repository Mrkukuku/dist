webpackJsonp([50],{"G+u4":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("mvHQ"),s=r.n(a),l={data:function(){return{ruleForm:{unitTime:"",unitAddress:"",unitContent:"",unitImage:[],sceneTime:"",sceneAddress:"",sceneContent:"",sceneImage:[],peopleTime:"",peopleAddress:"",peopleContent:"",peopleImage:[],delinquent:""},rules:{unitTime:[{required:!0,message:"请选择拍摄时间",trigger:"blur"}],unitAddress:[{required:!0,message:"请输入拍摄地址",trigger:"blur"}],unitContent:[{required:!0,message:"请输入拍摄描述",trigger:"blur"}],sceneTime:[{required:!0,message:"请选择拍摄时间",trigger:"blur"}],sceneAddress:[{required:!0,message:"请输入拍摄地址",trigger:"blur"}],sceneContent:[{required:!0,message:"请输入拍摄描述",trigger:"blur"}],peopleTime:[{required:!0,message:"请选择拍摄时间",trigger:"blur"}],peopleAddress:[{required:!0,message:"请输入拍摄地址",trigger:"blur"}],peopleContent:[{required:!0,message:"请输入拍摄描述",trigger:"blur"}],delinquent:[{required:!0,message:"请输入违法行为人签名",trigger:"blur"}]},disabled:!1,uploads:"",taskId:""}},methods:{handleRemove1:function(e){for(var t in this.ruleForm.unitImage)this.ruleForm.unitImage[t].uid==e.uid&&this.ruleForm.unitImage.splice(t,1)},handleRemove2:function(e){for(var t in this.ruleForm.sceneImage)this.ruleForm.sceneImage[t].uid==e.uid&&this.ruleForm.sceneImage.splice(t,1)},handleRemove3:function(e){for(var t in this.ruleForm.peopleImage)this.ruleForm.peopleImage[t].uid==e.uid&&this.ruleForm.peopleImage.splice(t,1)},handleChange1:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),r="jpg"===t,a="png"===t,s=e.size/1024/1024<10;return r||a?s?void(this.uploads=e.raw):(this.$message({message:"上传文件大小不能超过 10MB!",type:"warning"}),void this.$refs.upload1.clearFiles()):(this.$message({message:"上传文件只能是jpg,png格式!",type:"warning"}),void this.$refs.upload1.clearFiles())},handleChange2:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),r="jpg"===t,a="png"===t,s=e.size/1024/1024<10;return r||a?s?void(this.uploads=e.raw):(this.$message({message:"上传文件大小不能超过 10MB!",type:"warning"}),void this.$refs.upload2.clearFiles()):(this.$message({message:"上传文件只能是jpg,png格式!",type:"warning"}),void this.$refs.upload2.clearFiles())},handleChange3:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),r="jpg"===t,a="png"===t,s=e.size/1024/1024<10;return r||a?s?void(this.uploads=e.raw):(this.$message({message:"上传文件大小不能超过 10MB!",type:"warning"}),void this.$refs.upload3.clearFiles()):(this.$message({message:"上传文件只能是jpg,png格式!",type:"warning"}),void this.$refs.upload3.clearFiles())},upload1:function(){var e=this,t=this,r=new FormData;r.append("file",this.uploads),r.append("fileType",4),this.axios({url:"/api/admin/file/upload",method:"post",data:r}).then(function(r){0==r.data.code?e.ruleForm.unitImage.push({url:r.data.data.fileUrl,uid:e.uploads.uid}):t.$alert(r.data.msg,"提示",{confirmButtonText:"OK"})})},upload2:function(){var e=this,t=this,r=new FormData;r.append("file",this.uploads),r.append("fileType",4),this.axios({url:"/api/admin/file/upload",method:"post",data:r}).then(function(r){0==r.data.code?e.ruleForm.sceneImage.push({url:r.data.data.fileUrl,uid:e.uploads.uid}):t.$alert(r.data.msg,"提示",{confirmButtonText:"OK"})})},upload3:function(){var e=this,t=this,r=new FormData;r.append("file",this.uploads),r.append("fileType",4),this.axios({url:"/api/admin/file/upload",method:"post",data:r}).then(function(r){0==r.data.code?e.ruleForm.peopleImage.push({url:r.data.data.fileUrl,uid:e.uploads.uid}):t.$alert(r.data.msg,"提示",{confirmButtonText:"OK"})})},submitForm:function(e){var t=this,r=this;this.$refs[e].validate(function(e){if(e){t.ruleForm.unitImages=s()(t.ruleForm.unitImage),t.ruleForm.sceneImages=s()(t.ruleForm.sceneImage),t.ruleForm.peopleImages=s()(t.ruleForm.peopleImage);var a="/api/admin/police/images/add";t.taskId&&(a="/api/admin/police/images/update"),t.axios({method:"post",url:a,data:t.ruleForm}).then(function(e){0==e.data.code?(t.$message({message:"保存成功,即将跳转",type:"success"}),sessionStorage.setItem("taskId",e.data.data),setTimeout(function(){r.$router.push("/addTask")},1e3)):r.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})}})},blurTime:function(){this.ruleForm.unitTime&&(this.ruleForm.sceneTime=this.ruleForm.unitTime,this.ruleForm.peopleTime=this.ruleForm.unitTime)},getDetail:function(){var e=this;this.axios({method:"post",url:"/api/admin/police/images/single",data:{id:this.taskId}}).then(function(t){0==t.data.code?(e.ruleForm=t.data.data,e.ruleForm.unitImage=e.ruleForm.unitImages?JSON.parse(e.ruleForm.unitImages):[],e.ruleForm.sceneImage=e.ruleForm.sceneImages?JSON.parse(e.ruleForm.sceneImages):[],e.ruleForm.peopleImage=e.ruleForm.peopleImages?JSON.parse(e.ruleForm.peopleImages):[]):_this.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})}},mounted:function(){sessionStorage.getItem("taskId")&&(this.taskId=sessionStorage.getItem("taskId"),this.getDetail())}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"electronic"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules}},[r("div",{staticClass:"textDesc"},[e._v("单位门头照，表示违法行为存在位置")]),e._v(" "),r("el-form-item",{attrs:{label:"拍摄时间",prop:"unitTime"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{blur:e.blurTime},model:{value:e.ruleForm.unitTime,callback:function(t){e.$set(e.ruleForm,"unitTime",t)},expression:"ruleForm.unitTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"拍摄点",prop:"unitAddress"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.unitAddress,callback:function(t){e.$set(e.ruleForm,"unitAddress",t)},expression:"ruleForm.unitAddress"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"拍摄描述",prop:"unitContent"}},[r("el-input",{attrs:{type:"textarea",autocomplete:"off"},model:{value:e.ruleForm.unitContent,callback:function(t){e.$set(e.ruleForm,"unitContent",t)},expression:"ruleForm.unitContent"}})],1),e._v(" "),r("el-form-item",[r("div",{staticClass:"hoverImage"},[e._v("只能是jpg,png格式，最大10M")]),e._v(" "),r("el-upload",{ref:"unload1",attrs:{action:"#","list-type":"picture-card","on-change":e.handleChange1,multiple:"","http-request":e.upload1,"on-remove":e.handleRemove1,"file-list":e.ruleForm.unitImage,limit:5}},[r("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),e._v(" "),r("div",{staticClass:"textDesc"},[e._v("违法行为现场照片")]),e._v(" "),r("el-form-item",{attrs:{label:"拍摄时间",prop:"sceneTime"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.ruleForm.sceneTime,callback:function(t){e.$set(e.ruleForm,"sceneTime",t)},expression:"ruleForm.sceneTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"拍摄点",prop:"sceneAddress"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.sceneAddress,callback:function(t){e.$set(e.ruleForm,"sceneAddress",t)},expression:"ruleForm.sceneAddress"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"拍摄描述",prop:"sceneContent"}},[r("el-input",{attrs:{type:"textarea",autocomplete:"off"},model:{value:e.ruleForm.sceneContent,callback:function(t){e.$set(e.ruleForm,"sceneContent",t)},expression:"ruleForm.sceneContent"}})],1),e._v(" "),r("el-form-item",[r("div",{staticClass:"hoverImage"},[e._v("只能是jpg,png格式，最大10M")]),e._v(" "),r("el-upload",{ref:"unload2",attrs:{action:"#","list-type":"picture-card","on-change":e.handleChange2,"http-request":e.upload2,"on-remove":e.handleRemove2,"file-list":e.ruleForm.sceneImage,multiple:"",limit:5}},[r("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),e._v(" "),r("div",{staticClass:"textDesc"},[e._v("违法行为人现场照片")]),e._v(" "),r("el-form-item",{attrs:{label:"拍摄时间",prop:"peopleTime"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.ruleForm.peopleTime,callback:function(t){e.$set(e.ruleForm,"peopleTime",t)},expression:"ruleForm.peopleTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"拍摄点",prop:"peopleAddress"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.peopleAddress,callback:function(t){e.$set(e.ruleForm,"peopleAddress",t)},expression:"ruleForm.peopleAddress"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"拍摄描述",prop:"peopleContent"}},[r("el-input",{attrs:{type:"textarea",autocomplete:"off"},model:{value:e.ruleForm.peopleContent,callback:function(t){e.$set(e.ruleForm,"peopleContent",t)},expression:"ruleForm.peopleContent"}})],1),e._v(" "),r("el-form-item",[r("div",{staticClass:"hoverImage"},[e._v("只能是jpg,png格式，最大10M")]),e._v(" "),r("el-upload",{ref:"unload3",attrs:{action:"#","list-type":"picture-card","on-change":e.handleChange3,"http-request":e.upload3,multiple:"","on-remove":e.handleRemove3,"file-list":e.ruleForm.peopleImage,limit:5}},[r("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),e._v(" "),r("el-form-item",{attrs:{label:"违法行为人签名",prop:"delinquent"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.delinquent,callback:function(t){e.$set(e.ruleForm,"delinquent",t)},expression:"ruleForm.delinquent"}})],1),e._v(" "),r("el-form-item",{staticClass:"submitButton"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var o=r("VU/8")(l,i,!1,function(e){r("OSbL")},"data-v-15ea4b78",null);t.default=o.exports},OSbL:function(e,t){}});