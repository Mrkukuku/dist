webpackJsonp([44],{"/IOJ":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("g5qz"),r=a("MCsY"),o={mixins:[i.a],components:{pagination:r.a},data:function(){var t=this;return{dialogVisible:!1,module:"AreaModuleConfiguration",tableData:[],ruleForm:{areaName:"",unitNameList:[],id:""},props:{multiple:!0},options:[],rules:{areaName:[{validator:function(e,a,i){a?t.checkName(a)?setInterval(function(){t.nameFlag?i(new Error("名称已存在")):i()},500):i():i(new Error("请输入区域名称"))},required:!0,trigger:"blur"}],unitNameList:[{required:!0,message:"请选择区域",trigger:"blur"}]},nameFlag:!1,currentPage:1,rows:10,total:1}},methods:{checkName:function(){var t=this;return this.axios({url:"/api/admin/area/name/isexist",method:"post",data:{areaName:this.ruleForm.areaName,pageNum:1,pageSize:10,areaId:this.ruleForm.id}}).then(function(e){t.nameFlag=e.data.data}),!0},getUnitList:function(){var t=this;this.axios({url:"/api/admin/unit/all",method:"post",data:{}}).then(function(e){0==e.data.code?t.options=e.data.data:t.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})},handleSubmit:function(t){var e=this;this.ruleForm.id?this.axios({url:"/api/admin/area/update",method:"post",data:{id:this.ruleForm.id,areaName:this.ruleForm.areaName,unitIds:this.ruleForm.unitNameList}}).then(function(t){0==t.data.code?(e.$alert("修改成功","提示",{confirmButtonText:"OK"}),e.handleReset(),e.dialogVisible=!1,e.getData()):e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})}):this.axios({url:"/api/admin/area/register",method:"post",data:{areaName:this.ruleForm.areaName,unitIds:this.ruleForm.unitNameList}}).then(function(t){0==t.data.code?(e.$alert("添加成功","提示",{confirmButtonText:"OK"}),e.handleReset(),e.getData(),e.dialogVisible=!1):e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})},editData:function(t){var e=this;this.ruleForm.id=t,this.axios({url:"/api/admin/area/detail",method:"post",data:{id:t}}).then(function(t){e.dialogVisible=!0,e.ruleForm.areaName=t.data.data.areaName,e.ruleForm.unitNameList=t.data.data.unitIds})},handleDelete:function(t){var e=this;this.$confirm("你确定要删除吗").then(function(){e.axios({url:"/api/admin/area/delete",method:"post",data:{id:[t]}}).then(function(t){0==t.data.code?(e.$alert("删除成功","提示",{confirmButtonText:"OK"}),e.getData()):e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})})},handleReset:function(){this.ruleForm.areaName="",this.ruleForm.unitNameList="",this.ruleForm.id=""},closedialog:function(){this.dialogVisible=!1,this.handleReset()},pageChange:function(t){this.currentPage=t.page_index,this.rows=t.page_limit,this.getData()}},mounted:function(){this.getUnitList()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"allcontent",attrs:{id:"AreaModuleConfiguration"}},[a("div",{staticClass:"top"},[a("div",[a("el-button",{attrs:{type:"primary"},on:{click:t.opendialog}},[a("i",{staticClass:"el-icon-plus"}),t._v(" 新增")])],1)]),t._v(" "),a("div",{staticStyle:{"margin-top":"10px",height:"88%",position:"relative"}},[a("el-table",{staticStyle:{width:"150"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"areaName",label:"区域名称",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"unitNameList",label:"单位集合",width:"1000"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.editData(e.row.id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.row.id)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("div",{staticStyle:{position:"absolute",bottom:"0"}},[a("pagination",{attrs:{total:t.total},on:{pageChange:t.pageChange}})],1)],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{title:"添加修改区域",visible:t.dialogVisible,width:"30%","close-on-click-modal":!1,"before-close":t.closedialog},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"区域名称",prop:"areaName"}},[a("el-input",{model:{value:t.ruleForm.areaName,callback:function(e){t.$set(t.ruleForm,"areaName",e)},expression:"ruleForm.areaName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"单位集合",prop:"unitNameList"}},[a("el-cascader",{attrs:{options:t.options,props:t.props,"collapse-tags":"",clearable:""},model:{value:t.ruleForm.unitNameList,callback:function(e){t.$set(t.ruleForm,"unitNameList",e)},expression:"ruleForm.unitNameList"}})],1),t._v(" "),a("el-form-item",{staticClass:"formfooter"},[a("el-button",{attrs:{type:"primary",disabled:t.nameFlag},on:{click:function(e){return t.handleSubmit("ruleForm")}}},[t._v("立即提交")]),t._v(" "),a("el-button",{on:{click:function(e){return t.handleReset("ruleForm")}}},[t._v("重置")]),t._v(" "),a("el-button",{on:{click:t.closedialog}},[t._v("取 消")])],1)],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(o,n,!1,function(t){a("QE3w")},"data-v-2b7dd61c",null);e.default=l.exports},QE3w:function(t,e){}});