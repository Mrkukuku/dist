webpackJsonp([51],{IXd2:function(t,e){},vhTx:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("g5qz"),r=(a("inaZ"),a("MCsY")),l={mixins:[i.a],components:{pagination:r.a},data:function(){return{module:"train/task",taskName:"",tacktime:"",Jurisdiction:sessionStorage.getItem("unitId"),FileList:[],factoryList:[],unitIds_cascader:[],props:{multiple:!0,checkStrictly:!0},options:[],ruleForm:{id:null,taskName:"",trainFileId:"",trainTime:"",unitIds:[],depict:""},rules:{taskName:[{required:!0,message:"请输入培训名称",trigger:"blur"}],trainFileId:[{required:!0,message:"请输入培训文件",trigger:"blur"}],trainTime:[{required:!0,message:"请输入培训时间",trigger:"blur"}],unitIds:[{required:!0,message:"请选择单位集合",trigger:"blur"}]},expireTimeOption:{disabledDate:function(t){return t.getTime()+864e5<Date.now()}},currentPage:1,rows:10,total:1}},methods:{filelist:function(){var t=this;this.axios({url:"/api/admin/train/file/list",method:"post",data:{unitId:sessionStorage.getItem("unitId"),pageSize:999,pageNum:1}}).then(function(e){0==e.data.code?e.data.list&&(t.FileList=e.data.list):t.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})},factorylist:function(){var t=this;this.axios({url:"/api/admin/unit/task/list",method:"post"}).then(function(e){0==e.data.code?e.data.data&&(t.factoryList=e.data.data):t.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})},searchtraniningtask:function(){var t=this;this.currentPage=1,this.$refs.paginationChild.changePageNum(this.currentPage),this.axios({url:"/api/admin/train/task/list",method:"post",data:{unitId:sessionStorage.getItem("unitId"),pageSize:this.rows,pageNum:this.currentPage,taskName:this.taskName,trainTime:this.tacktime}}).then(function(e){if(0==e.data.code){if(t.tableData=e.data.list,t.total=e.data.total,t.currentPage=e.data.pageNum,t.tableData)for(var a=0;a<t.tableData.length;a++)t.tableData[a].trainTime=t.$moment(t.tableData[a].trainTime).format("YYYY-MM-DD")}else t.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})},resettraniningtask:function(){this.taskName="",this.tacktime="",this.searchtraniningtask()},handledownload:function(t){var e=this;this.axios({url:"/api/admin/train/file/search/single",method:"post",data:{id:t}}).then(function(t){0==t.data.code?location.open(t.data.data.filePath):e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})},getBlob:function(t,e){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="blob",a.onload=function(){200===a.status&&e(a.response)},a.send()},saveAs:function(t,e){if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(t,e);else{var a=document.createElement("a"),i=document.querySelector("body");a.href=window.URL.createObjectURL(t),a.download=e,a.style.display="none",i.appendChild(a),a.click(),i.removeChild(a),window.URL.revokeObjectURL(a.href)}},cascadervalue:function(t){var e=[];console.log(t);for(var a=0;a<t.length;a++)for(var i=0;i<t[a].length;i++)-1==e.indexOf(t[a][i])&&e.push(t[a][i]);var r=t.join("-");this.ruleForm.unitIds=e,console.log(this.ruleForm.unitIds),this.ruleForm.note=r},pageChange:function(t){this.currentPage=t.page_index,this.rows=t.page_limit,this.getData()}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"allcontent",attrs:{id:"trainingtask"}},[a("div",{staticClass:"top"},[a("div",[t._v("\n                 培训计划名称:\n                "),a("el-input",{model:{value:t.taskName,callback:function(e){t.taskName=e},expression:"taskName"}}),t._v("\n                  培训时间:\n                "),a("el-date-picker",{attrs:{type:"date",placeholder:"请输入培训时间"},model:{value:t.tacktime,callback:function(e){t.tacktime=e},expression:"tacktime"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.searchtraniningtask}},[t._v("查询")]),t._v(" "),a("el-button",{on:{click:t.resettraniningtask}},[t._v("重置")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.opendialog}},[a("i",{staticClass:"el-icon-plus"}),t._v(" 新增")])],1)]),t._v(" "),a("div",{staticStyle:{"margin-top":"10px",height:"88%",position:"relative"}},[a("el-table",{staticStyle:{width:"150"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"taskName",label:"培训计划名称",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"trainFileName",label:"培训文件",width:"250"}}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"发布人",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"depict",label:"培训大纲",width:"350"}}),t._v(" "),a("el-table-column",{attrs:{prop:"trainTime",label:"培训时间",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.editData(e.row.id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.row.id)}}},[t._v("删除")]),t._v(" "),a("el-button",{staticClass:"el-icon-download",attrs:{size:"mini",type:"success"},on:{click:function(a){return t.handledownload(e.row.trainFileId)}}},[t._v("下载")])]}}])})],1),t._v(" "),a("div",{staticStyle:{position:"absolute",bottom:"0"}},[a("pagination",{ref:"paginationChild",attrs:{total:t.total},on:{pageChange:t.pageChange}})],1)],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{title:"添加修改培训任务",visible:t.dialogVisible,width:"30%","close-on-click-modal":!1,"before-close":t.closedialog},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"培训名称",prop:"taskName"}},[a("el-input",{model:{value:t.ruleForm.taskName,callback:function(e){t.$set(t.ruleForm,"taskName",e)},expression:"ruleForm.taskName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"培训文件",prop:"trainFileId"}},[a("el-select",{attrs:{placeholder:"--请选择--"},model:{value:t.ruleForm.trainFileId,callback:function(e){t.$set(t.ruleForm,"trainFileId",e)},expression:"ruleForm.trainFileId"}},t._l(t.FileList,function(t){return a("el-option",{key:t.id,attrs:{label:t.fileName,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"单位集合",prop:"unitIds"}},[a("el-cascader",{attrs:{options:t.factoryList,props:t.props,"collapse-tags":"",clearable:""},on:{change:t.cascadervalue},model:{value:t.unitIds_cascader,callback:function(e){t.unitIds_cascader=e},expression:"unitIds_cascader"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"培训时间",prop:"trainTime"}},[a("el-date-picker",{attrs:{type:"date","picker-options":t.expireTimeOption,"value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.ruleForm.trainTime,callback:function(e){t.$set(t.ruleForm,"trainTime",e)},expression:"ruleForm.trainTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"培训描述",prop:"depict"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.depict,callback:function(e){t.$set(t.ruleForm,"depict",e)},expression:"ruleForm.depict"}})],1),t._v(" "),a("el-form-item",{staticClass:"formfooter"},[a("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("ruleForm")}}},[t._v("立即提交")]),t._v(" "),a("el-button",{on:{click:t.closedialog}},[t._v("取 消")])],1)],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(l,n,!1,function(t){a("IXd2")},"data-v-0f393f9f",null);e.default=o.exports}});