webpackJsonp([19],{AGcI:function(e,t){},ird7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("g5qz"),i=a("MCsY"),s={mixins:[l.a],components:{pagination:i.a},data:function(){var e=this;return{module:"log",username:"",type:"",startTime:"",endTime:"",userTypes:sessionStorage.getItem("userTypes"),treedefaultProps:{children:"children",label:"label"},options:[{value:"1",label:"用户操作"},{value:"2",label:"单位操作"},{value:"3",label:"建筑操作"},{value:"4",label:"培训任务操作"},{value:"5",label:"通讯录操作"},{value:"6",label:"设备操作"},{value:"7",label:"培训资料操作"},{value:"8",label:"设备资料操作"}],options1:[{value:"1",label:"用户操作"},{value:9,label:"设备离线日志"},{value:10,label:"设备故障日志"}],options2:[{value:"1",label:"用户操作"},{value:"2",label:"单位操作"},{value:"3",label:"建筑操作"},{value:"4",label:"培训任务操作"},{value:"5",label:"通讯录操作"},{value:"6",label:"设备操作"},{value:"7",label:"培训资料操作"},{value:"8",label:"设备资料操作"}],expireTimeOptionEnd:{disabledDate:function(t){var a=e.startTime;if(a)return t.getTime()<new Date(a).getTime()}},platform:!0,platFromName:"后台",isBackSystem:0,currentPage:1,rows:10,total:1}},methods:{filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},switchType:function(){this.platform?(this.options=this.options2,this.platFromName="后台",this.isBackSystem=0):(this.options=this.options1,this.platFromName="监测平台",this.isBackSystem=1),this.searchreset()},searchsubmit:function(){var e=this;this.currentPage=1,this.$refs.paginationChild.changePageNum(this.currentPage),this.axios({url:"/api/admin/"+this.module+"/list",method:"post",dataType:"json",data:{unitId:this.companyId,pageNum:this.currentPage,pageSize:this.rows,username:this.username,type:this.type,startTime:this.startTime,endTime:this.endTime,isBackSystem:this.isBackSystem}}).then(function(t){0==t.data.code?(e.tableData=t.data.list,e.tableData.map(function(t){t.createdTime=t.createdTime&&e.$moment(t.createdTime).format("YYYY-MM-DD HH:mm:ss")||""}),e.total=t.data.total,e.currentPage=t.data.pageNum):e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})},searchreset:function(){this.username="",this.type="",this.startTime="",this.endTime="",this.getData()},renderContent:function(e,t){var a=t.node;return e("span",[e("i",{class:t.data.icon})," ",e("span",[a.label])])},handleNodeClick:function(e){this.companyId=e.id,this.rows=10,this.currentPage=1,this.getData()},pageChange:function(e){this.currentPage=e.page_index,this.rows=e.page_limit,this.getData()}},created:function(){this.companyId=sessionStorage.getItem("unitId")}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"allcontent",attrs:{id:"logManagement"}},[3!=e.userTypes?a("el-col",{staticClass:"tree_box",attrs:{span:4}},[a("div",[a("el-input",{staticClass:"filter_text",attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",attrs:{data:e.Treedata,props:e.treedefaultProps,"render-content":e.renderContent,"highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}})],1)]):e._e(),e._v(" "),a("el-col",{staticStyle:{height:"100%"},attrs:{span:20}},[a("div",{staticClass:"top"},[a("div",{staticStyle:{"margin-left":"10px"}},[e._v("\n               "+e._s(e.platFromName)+":\n               "),a("el-switch",{attrs:{"active-color":"#66b1ff","inactive-color":"#66b1ff"},on:{change:e.switchType},model:{value:e.platform,callback:function(t){e.platform=t},expression:"platform"}}),e._v("\n                操作者:\n                "),a("el-input",{model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v("  \n                日志类型:"),a("el-select",{attrs:{placeholder:"Select"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})}),1),e._v("\n                时间日期："),a("el-date-picker",{staticClass:"picker",attrs:{type:"date",placeholder:"选择开始日期时间","value-format":"yyyy-MM-dd"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}}),e._v(" -\n                    "),a("el-date-picker",{staticClass:"picker",attrs:{type:"date","picker-options":e.expireTimeOptionEnd,"value-format":"yyyy-MM-dd",placeholder:"选择结束日期时间"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.searchsubmit}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:e.searchreset}},[e._v("重置")])],1)]),e._v(" "),a("div",{staticClass:"bottom"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"selection-change":e.SelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"操作者",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userIp",label:"操作IP",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"操作内容"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createdTime",label:"操作时间",width:"230"}})],1),e._v(" "),a("div",{staticClass:"page_all"},[a("pagination",{ref:"paginationChild",attrs:{total:e.total},on:{pageChange:e.pageChange}})],1)],1)])],1)},staticRenderFns:[]};var r=a("VU/8")(s,n,!1,function(e){a("AGcI")},"data-v-8d361df8",null);t.default=r.exports}});