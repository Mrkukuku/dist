webpackJsonp([53],{"V8+K":function(e,t){},kECV:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i("g5qz"),a=i("inaZ"),r={mixins:[l.a],data:function(){return{module:"device/lib",name:"",type:"",system:"",show:!0,Jurisdiction:sessionStorage.getItem("unitId"),updateVisible:!1,informationData:"",EquipmentVisibleData:!1,imgList:[],imgNumber:null,posterURL:"",upload:"",page:null,protocolList:[],accessTypeList:[],intelligentFireList:[],deviceTypeList:[],EquipmentVisible:!1,ruleForm:{id:null,deviceName:"",deviceModel:"",deviceTypeId:"",intelligentFireSystemId:"",manufacturer:"",manufacturerTel:"",supplier:"",supplierTel:"",brand:"",protocolId:"",accessType:"",deviceImgUrl:""},rules:{deviceModel:[{required:!0,message:"请输入设备型号",trigger:"blur"}],deviceName:[{required:!0,message:"请输入设备名称",trigger:"blur"}],deviceTypeId:[{required:!0,message:"请输入设备类型",trigger:"blur"}],intelligentFireSystemId:[{required:!0,message:"请输入设备隶属系统",trigger:"blur"}],accessType:[{required:!0,message:"请选择设备接入类型",trigger:"blur"}]},pickerOptions1:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}}}},methods:{openEquipment:function(e){this.Select(1),this.Select(3),this.EquipmentVisible=!0;var t=this;this.axios({url:"/api/admin/device/lib/single",method:"post",data:{id:e}}).then(function(e){0==e.data.code?(t.ruleForm=e.data.data,t.deviceType(""),t.Select(3),t.Select(1)):t.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})},EquipmentClose:function(){this.EquipmentVisible=!1,this.EquipmentVisibleData=!1},beforeUpload:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),i="jpg"===t,l="png"===t,a=e.size/1024/1024<5;return i||l?a?(this.posterURL=URL.createObjectURL(e.raw),void(this.upload=e.raw)):(this.$message({message:"上传文件大小不能超过 5MB!",type:"warning"}),this.$refs.upload.clearFiles(),void(this.files=null)):(this.$message({message:"上传文件只能是jpg,png格式!",type:"warning"}),this.$refs.upload.clearFiles(),void(this.ruleForm.unitPlanUrl=null))},uploads:function(){var e=this,t=new FormData;t.append("file",this.upload),t.append("fileType",1),this.axios({url:"/api/admin/file/upload",method:"post",data:t}).then(function(t){0==t.data.code?(e.ruleForm.deviceImgUrl=t.data.data.fileUrl,e.$alert("上传成功","提示",{confirmButtonText:"OK"})):e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})},resetUploads:function(){this.ruleForm.deviceImgUrl=null,this.posterURL=""},carouselChange:function(e){this.currentPage=e+1,this.getData()},searchReset:function(){this.name="",this.type="",this.system="",this.searchsubmit()},Select:function(e){var t=this;this.axios({url:"/api/admin/device/dict",method:"post",data:{id:e}}).then(function(i){0==i.data.code?3==e?t.protocolList=i.data.data:1==e?t.accessTypeList=i.data.data:4==e&&(t.intelligentFireList=i.data.data,t.deviceType("")):t.$alert(i.data.msg,"提示",{confirmButtonText:"OK"})})},openupdatedialog:function(){this.updateVisible=!0,this.Select(3),this.Select(1)},closeupdatedialog:function(){this.updateVisible=!1,this.handleReset()},currentSel:function(e){this.ruleForm.deviceTypeId="",this.type="",this.deviceType(e)},deviceType:function(e){var t=this;this.axios({url:"/api/admin/device/system?id="+e,method:"post"}).then(function(e){t.deviceTypeList=e.data.data})},update_insert:function(e){var t=this,i=this;this.$refs[e].validate(function(e){if(!e)return i.$alert("添加数据失败","提示",{confirmButtonText:"OK"}),!1;t.$refs.ruleForm.model.id?t.axios({url:"/api/admin/device/lib/detail",method:"post",data:t.ruleForm}).then(function(e){0==e.data.code?i.$alert("修改成功","提示",{confirmButtonText:"OK",callback:function(){i.handleReset(),i.updateVisible=!1,i.getData()}}):i.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})}):(delete t.ruleForm.id,t.axios({url:"/api/admin/device/lib/detail",method:"post",dataType:"json",data:t.ruleForm}).then(function(e){0==e.data.code?(i.$alert("添加数据成功!","提示",{confirmButtonText:"OK"}),i.updateVisible=!1,i.handleReset(),i.getData()):i.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})}))})},searchsubmit:function(){var e=this;this.axios({url:"/api/admin/"+this.module+"/list",method:"post",dataType:"json",data:{pageNum:this.currentPage,pageSize:this.rows,deviceName:this.name,deviceTypeId:this.type,intelligentFireSystemId:this.system}}).then(function(t){0==t.data.code?(e.tableData=t.data.list,e.total=t.data.total,e.currentPage=t.data.pageNum,e.page=Math.ceil(e.total/10),t.data.list.length?e.show=!0:e.show=!1):e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})},handleFile:function(e){this.dataList(e)},dataList:function(e){var t=this;this.axios({url:"/api/admin/device/lib/file.list",method:"post",data:{id:e}}).then(function(e){0==e.data.code?(t.informationData=e.data.data,t.EquipmentVisibleData=!0):t.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})},dataDownload:function(e){var t=this;this.axios({url:"/api/admin/device/lib/file.single",method:"post",data:{id:e}}).then(function(e){if(0==e.data.code){var i=new XMLHttpRequest;i.open("GET",e.data.data.filePath,!0),i.responseType="blob",i.onload=function(){Object(a.a)(i.response,e.data.data.fileName,"text/plain")},i.send()}else t.$alert(e.data.msg,"提示",{confirmButtonText:"OK"})})}},mounted:function(){this.Select(4),this.deviceType(""),this.Select(3),this.Select(1)},computed:{intelligentFireListruleform:function(){var e=this;return this.intelligentFireList.filter(function(t){return t.code==e.ruleForm.intelligentFireSystemId})},deviceTypeListruleform:function(){var e=this;return!!this.deviceTypeList&&this.deviceTypeList.filter(function(t){return t.code==e.ruleForm.deviceTypeId})},protocolListruleform:function(){var e=this;return this.protocolList.filter(function(t){return t.code==e.ruleForm.protocolId})},accessTypeListruleform:function(){var e=this;return this.accessTypeList.filter(function(t){return t.code==e.ruleForm.accessType})}}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"allcontent",attrs:{id:"EquipmentLibrary"}},[i("div",{staticClass:"top"},[i("div",[e._v("\n            设备名称:\n            "),i("el-input",{model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v("\n            隶属系统:"),i("el-select",{attrs:{placeholder:"--请选择--"},on:{change:e.currentSel},model:{value:e.system,callback:function(t){e.system=t},expression:"system"}},e._l(e.intelligentFireList,function(e){return i("el-option",{key:e.code,attrs:{label:e.description,value:e.code}})}),1),e._v("\n            设备类型:"),i("el-select",{attrs:{placeholder:"--请选择--"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.deviceTypeList,function(e){return i("el-option",{key:e.code,attrs:{label:e.description,value:e.code}})}),1),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.searchsubmit}},[e._v("查询")]),e._v(" "),i("el-button",{on:{click:e.searchReset}},[e._v("重置")]),e._v(" "),-1==e.Jurisdiction?i("span",[i("el-button",{attrs:{type:"primary"},on:{click:e.openupdatedialog}},[i("i",{staticClass:"el-icon-plus"}),e._v(" 新增")])],1):e._e()],1)]),e._v(" "),i("div",{staticClass:"bottom"},[e.show?i("el-carousel",{attrs:{autoplay:!1,arrow:"always"},on:{change:e.carouselChange}},e._l(e.page,function(t){return i("el-carousel-item",{key:t,staticStyle:{"text-align":"center",padding:"0% 5%",width:"91%"}},e._l(e.tableData,function(t){return i("div",{key:t.id,staticStyle:{width:"14.5%",height:"45%",float:"left",margin:"1% 2.5%",background:"#ffffff"}},[i("div",{staticClass:"photobox"},[i("p",{staticClass:"pictrue"},[i("img",{attrs:{src:t.deviceImgUrl},on:{click:function(i){return e.openEquipment(t.id)}}})]),e._v(" "),i("div",{staticClass:"Equipmentbox"},[i("p",{staticClass:"title"},[e._v("名称:"+e._s(t.deviceName))]),e._v(" "),i("p",{staticClass:"descript"},[e._v("型号:"+e._s(t.deviceModel))]),e._v(" "),-1==e.Jurisdiction?i("p",{staticClass:"Equipmentbutton"},[i("el-button",{attrs:{type:"primary",round:""},on:{click:function(i){return e.editData(t.id)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{type:"danger",round:""},on:{click:function(i){return e.handleDelete(t.id)}}},[e._v("删除")]),e._v(" "),i("el-button",{attrs:{type:"success",round:""},on:{click:function(i){return e.handleFile(t.id)}}},[e._v("文档")])],1):i("p",{staticClass:"Equipmentbutton",staticStyle:{"text-align":"right"}},[i("el-button",{attrs:{type:"success",round:""},on:{click:function(i){return e.handleFile(t.id)}}},[e._v("文档")])],1)])])])}),0)}),1):i("div",{staticStyle:{"text-align":"center","padding-top":"100px"}},[i("h3",[e._v("暂无数据")])])],1),e._v(" "),i("el-dialog",{attrs:{title:"设备新增修改页面",visible:e.updateVisible,width:"43%","close-on-click-modal":!1,"before-close":e.closeupdatedialog},on:{"update:visible":function(t){e.updateVisible=t}}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,inline:!0,data:e.ruleForm,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"设备名称",prop:"deviceName"}},[i("el-input",{model:{value:e.ruleForm.deviceName,callback:function(t){e.$set(e.ruleForm,"deviceName",t)},expression:"ruleForm.deviceName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备型号",prop:"deviceModel"}},[i("el-input",{model:{value:e.ruleForm.deviceModel,callback:function(t){e.$set(e.ruleForm,"deviceModel",t)},expression:"ruleForm.deviceModel"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备隶属系统",prop:"intelligentFireSystemId"}},[i("el-select",{attrs:{placeholder:"--请选择--"},on:{change:e.currentSel},model:{value:e.ruleForm.intelligentFireSystemId,callback:function(t){e.$set(e.ruleForm,"intelligentFireSystemId",t)},expression:"ruleForm.intelligentFireSystemId"}},e._l(e.intelligentFireList,function(e){return i("el-option",{key:e.code,attrs:{label:e.description,value:e.code}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"设备类型",prop:"deviceTypeId"}},[i("el-select",{attrs:{placeholder:"--请选择--"},model:{value:e.ruleForm.deviceTypeId,callback:function(t){e.$set(e.ruleForm,"deviceTypeId",t)},expression:"ruleForm.deviceTypeId"}},e._l(e.deviceTypeList,function(e){return i("el-option",{key:e.code,attrs:{label:e.description,value:e.code}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"设备接入类型",prop:"accessType"}},[i("el-select",{attrs:{placeholder:"--请选择--"},model:{value:e.ruleForm.accessType,callback:function(t){e.$set(e.ruleForm,"accessType",t)},expression:"ruleForm.accessType"}},e._l(e.accessTypeList,function(e){return i("el-option",{key:e.code,attrs:{label:e.description,value:e.code}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"设备生产商",prop:"manufacturer"}},[i("el-input",{model:{value:e.ruleForm.manufacturer,callback:function(t){e.$set(e.ruleForm,"manufacturer",t)},expression:"ruleForm.manufacturer"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"生厂商电话",prop:"manufacturerTel"}},[i("el-input",{model:{value:e.ruleForm.manufacturerTel,callback:function(t){e.$set(e.ruleForm,"manufacturerTel",t)},expression:"ruleForm.manufacturerTel"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备供应商",prop:"supplier"}},[i("el-input",{model:{value:e.ruleForm.supplier,callback:function(t){e.$set(e.ruleForm,"supplier",t)},expression:"ruleForm.supplier"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"供应商电话",prop:"supplierTel"}},[i("el-input",{model:{value:e.ruleForm.supplierTel,callback:function(t){e.$set(e.ruleForm,"supplierTel",t)},expression:"ruleForm.supplierTel"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[i("el-input",{model:{value:e.ruleForm.brand,callback:function(t){e.$set(e.ruleForm,"brand",t)},expression:"ruleForm.brand"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备协议类型",prop:"protocolId"}},[i("el-select",{attrs:{placeholder:"--请选择--"},model:{value:e.ruleForm.protocolId,callback:function(t){e.$set(e.ruleForm,"protocolId",t)},expression:"ruleForm.protocolId"}},e._l(e.protocolList,function(e){return i("el-option",{key:e.code,attrs:{label:e.description,value:e.code}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"设备图片",prop:"deviceImgUrl"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"",accept:".jpg,.png,.JPG,.PNG","show-file-list":!1,"on-change":e.beforeUpload,"auto-upload":!1}},[e.posterURL?i("img",{staticClass:"avatar",attrs:{src:e.posterURL}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),i("el-button",{on:{click:e.uploads}},[e._v("立即上传")]),e._v(" "),i("el-button",{on:{click:e.resetUploads}},[e._v("取消")])],1),e._v(" "),i("el-form-item",{staticClass:"formfooter"},[i("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:function(t){return e.update_insert("ruleForm")}}},[e._v("立即提交")]),e._v(" "),i("el-button",{on:{click:e.closeupdatedialog}},[e._v("取 消")])],1)],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"设备详情",visible:e.EquipmentVisible,width:"40%","close-on-click-modal":!1,"before-close":e.EquipmentClose},on:{"update:visible":function(t){e.EquipmentVisible=t}}},[i("table",{staticClass:"detail_table"},[i("tr",[i("td",{staticStyle:{width:"250px",height:"250px","text-align":"center"},attrs:{rowspan:"5"}},[i("span",{staticStyle:{display:"inline-block",width:"250px",height:"200px"}},[i("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.ruleForm.deviceImgUrl}})])]),e._v(" "),i("td",[e._v("设备名称:"+e._s(e.ruleForm.deviceName))])]),e._v(" "),i("tr",[i("td",[e._v("设备型号:"+e._s(e.ruleForm.deviceModel))])]),e._v(" "),i("tr",e._l(e.intelligentFireListruleform,function(t){return i("td",{key:t.code},[i("span",[e._v("设备隶属系统:"+e._s(t.description))])])}),0),e._v(" "),i("tr",e._l(e.deviceTypeListruleform,function(t){return i("td",{key:t.code},[i("span",[e._v("设备类型:"+e._s(t.description))])])}),0),e._v(" "),i("tr",[i("td",[e._v("设备品牌:"+e._s(e.ruleForm.brand))])]),e._v(" "),i("tr",[i("td",[e._v("设备生产商:"+e._s(e.ruleForm.manufacturer))]),e._v(" "),i("td",[e._v("生厂商电话:"+e._s(e.ruleForm.manufacturerTel))])]),e._v(" "),i("tr",[i("td",[e._v("设备供应商:"+e._s(e.ruleForm.supplier))]),e._v(" "),i("td",[e._v("供应商电话:"+e._s(e.ruleForm.supplierTel))])]),e._v(" "),i("tr",[e._l(e.protocolListruleform,function(t){return i("td",{key:t.code},[e._v("设备协议类型:"+e._s(t.description))])}),e._v(" "),e._l(e.accessTypeListruleform,function(t){return i("td",{key:t.code+2},[e._v("设备接入类型:"+e._s(t.description))])})],2)])]),e._v(" "),i("el-dialog",{attrs:{title:"设备文档",visible:e.EquipmentVisibleData,width:"50%","close-on-click-modal":!1,"before-close":e.EquipmentClose},on:{"update:visible":function(t){e.EquipmentVisibleData=t}}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.informationData,border:""}},[i("el-table-column",{attrs:{prop:"fileName",label:"资料名称",width:"230"}}),e._v(" "),i("el-table-column",{attrs:{prop:"fileDesc",label:"资料描述",width:"500"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticClass:"el-icon-download",attrs:{size:"mini",type:"success"},on:{click:function(i){return e.dataDownload(t.row.id)}}},[i("a",{attrs:{id:"download"}},[e._v("下载")])])]}}])})],1)],1)],1)},staticRenderFns:[]};var s=i("VU/8")(r,o,!1,function(e){i("V8+K")},null,null);t.default=s.exports}});