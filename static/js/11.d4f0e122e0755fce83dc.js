webpackJsonp([11],{ar4J:function(e,t){},ozm9:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("Dd8w"),a=r.n(i),l={mixins:[r("g5qz").a],data:function(){var e=this;return{module:"pollingConfig",userType:"",unitId:"",Treedata:[],addFalg:!1,ruleForm:{startTime:"",fireInspectionNum:"",unitId:"",endTime:"",display:"0",intervalTime:2},rules:{startTime:[{required:!0,message:"请选择开始时间",trigger:"blur"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"blur"}],fireInspectionNum:[{required:!0,message:"请输入巡检次数",trigger:"blur"}],intervalTime:[{required:!0,message:"请输入巡检间隔",trigger:"blur"},{validator:function(t,r,i){if(""!==r&&null!=r||i(new Error("请输入巡检间隔")),r){var a=parseInt(r);e.ruleForm.intervalTime=a>=0?a:-1*a,i()}else i(new Error("巡检间隔时间过长"))},required:!0,trigger:"change"}]},gradeData:[{value:0,label:"否"},{value:1,label:"是"}]}},methods:{handleSubmit:function(e){var t=this,r=this;this.$refs[e].validate(function(e){if(e){var i="";i=r.ruleForm.id?"/api/admin/fire/inspection/config/update":"/api/admin/fire/inspection/config/add",r.axios({url:i,method:"post",data:a()({},t.ruleForm)}).then(function(e){e.data.code,r.$alert(e.data.msg)})}else t.$alert("请填写必填字段")})},reset:function(){this.ruleForm.startTime="",this.ruleForm.fireInspectionNum=""},getData:function(){var e=this;this.unitId&&this.axios({url:"/api/admin/fire/inspection/config/single",method:"post",data:{id:this.unitId}}).then(function(t){0==t.data.code&&(e.ruleForm=t.data.data)})},handleNodeClick:function(e){this.unitId=e.id,this.ruleForm.unitId=e.id,0==e.type?this.addFalg=!1:(this.addFalg=!0,this.getData())},Treeunit:function(){var e=this;this.axios({url:"/api/admin/unit/list.left",method:"post",params:{pageNum:1,pageSize:1e3}}).then(function(t){if(0==t.data.code){if(t.data.data){e.Treedata=t.data.data,e.data=t.data.data;for(var r=0;r<e.Treedata.length;r++)e.Treedata[r].icon="el-icon-folder"}}else e.$alert(t.data.msg,"提示",{confirmButtonText:"OK"})})}},mounted:function(){this.userType=sessionStorage.getItem("userTypes"),this.unitId=Number(sessionStorage.getItem("unitId")),this.ruleForm.unitId=Number(sessionStorage.getItem("unitId")),3==this.userType?(this.addFalg=!0,this.getData()):this.Treeunit()}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"allcontent",attrs:{id:"polling_config"}},[r("el-row",{staticStyle:{height:"100%"}},[3!=e.userType?r("el-col",{staticClass:"tree_box",attrs:{span:4}},[r("div",[r("el-input",{staticClass:"filter_text",attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),r("el-tree",{ref:"tree",attrs:{data:e.Treedata,props:e.defaultProps,"render-content":e.renderContent,"highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}})],1)]):e._e(),e._v(" "),r("el-col",{staticStyle:{height:"100%",border:"1px solid #eee"},attrs:{span:20}},[r("div",{staticStyle:{"margin-top":"10px",height:"88%",position:"relative","padding-left":"10px"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.addFalg,expression:"addFalg"}]},[r("el-form",{ref:"ruleForm",staticStyle:{width:"350px"},attrs:{model:e.ruleForm,"label-width":"150px",rules:e.rules}},[r("el-form-item",{attrs:{label:"是否只显示当前任务",prop:"startTime"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.display,callback:function(t){e.$set(e.ruleForm,"display",t)},expression:"ruleForm.display"}},e._l(e.gradeData,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"巡检开始时间",prop:"startTime"}},[r("el-time-picker",{attrs:{"value-format":"HH:mm",format:"HH:mm",placeholder:"巡检开始时间"},model:{value:e.ruleForm.startTime,callback:function(t){e.$set(e.ruleForm,"startTime",t)},expression:"ruleForm.startTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"巡检结束时间",prop:"endTime"}},[r("el-time-picker",{attrs:{"value-format":"HH:mm",format:"HH:mm",placeholder:"巡检结束时间"},model:{value:e.ruleForm.endTime,callback:function(t){e.$set(e.ruleForm,"endTime",t)},expression:"ruleForm.endTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"巡检次数",prop:"fireInspectionNum"}},[r("el-input",{attrs:{type:"number",placeholder:"巡检次数"},model:{value:e.ruleForm.fireInspectionNum,callback:function(t){e.$set(e.ruleForm,"fireInspectionNum",t)},expression:"ruleForm.fireInspectionNum"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"巡检间隔",prop:"intervalTime"}},[r("el-input",{attrs:{type:"number",placeholder:"巡检次数"},model:{value:e.ruleForm.intervalTime,callback:function(t){e.$set(e.ruleForm,"intervalTime",t)},expression:"ruleForm.intervalTime"}}),e._v("小时\r\n                    ")],1),e._v(" "),r("el-form-item",{staticClass:"submitagency"},[r("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("ruleForm")}}},[e._v("立即提交")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1)])])],1)],1)},staticRenderFns:[]};var o=r("VU/8")(l,n,!1,function(e){r("ar4J")},null,null);t.default=o.exports}});