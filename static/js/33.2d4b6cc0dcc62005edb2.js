webpackJsonp([33],{"8Z6j":function(t,e){},XcGw:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("g5qz"),s=a("MCsY"),n={mixins:[i.a],components:{pagination:s.a},data:function(){var t=this;return{radio:1,module:"inspectionRecord",userType:"",unitId:"",currentPage:1,rows:10,total:0,tableData:[],startTime:"",endTime:"",department:"",pollingVisible:!1,pollingVisible1:!1,pollingDetail:{},maintenance:{},expireTimeOptionStart:{disabledDate:function(e){var a=t.endTime;return a&&e.getTime()>new Date(a).getTime()||e.getTime()>Date.now()}},expireTimeOptionEnd:{disabledDate:function(e){var a=t.startTime,i=new Date(a).getTime();return a&&e.getTime()<i||e.getTime()>Date.now()}}}},methods:{editData:function(t){var e=this;this.axios({url:"/api/admin/month/inspection/single",method:"post",data:{id:t.id,type:t.maintenanceType}}).then(function(a){0==a.data.code?1==t.maintenanceType?(e.pollingDetail=a.data.data,e.pollingVisible=!0):(e.maintenance=a.data.data,e.pollingVisible1=!0):e.$alert(a.data.msg)})},exportPolling:function(){var t=this;this.axios({url:"/api/admin/month/inspection/info/excel",method:"post",data:{startTime:this.startTime,endTime:this.endTime,unitId:this.unitId,type:1}}).then(function(e){0==e.data.code&&e.data.data&&(location.href=e.data.data),e.data.msg&&t.$alert(e.data.msg)})},seach:function(){this.currentPage=1,this.getDatas(),this.$refs.paginations.changePageNum(1)},getDatas:function(){var t=this;this.axios({url:"/api/admin/month/inspection/list",method:"post",data:{startTime:this.startTime,endTime:this.endTime,unitId:this.unitId,pageSize:this.rows,pageNum:this.currentPage,uname:this.department}}).then(function(e){0==e.data.code?(t.tableData=e.data.data.list,t.total=e.data.data.total):t.$alert(e.data.msg)})},getData:function(){},handleReset:function(){this.startTime="",this.endTime="",this.department="",this.currentPage=1,this.$refs.paginations.changePageNum(1),this.getDatas()},pageChange:function(t){this.currentPage=t.page_index,this.rows=t.page_limit,this.getDatas()},renderContent:function(t,e){var a=e.node;return t("span",[t("i",{class:e.data.icon})," ",t("span",[a.label])])},handleNodeClick:function(t){this.unitId=t.id,this.getDatas()}},mounted:function(){this.userType=sessionStorage.getItem("userTypes"),this.unitId=Number(sessionStorage.getItem("unitId")),3==this.userType&&this.getDatas()}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"allcontent",attrs:{id:"fire_watch"}},[a("el-row",{staticStyle:{height:"100%"}},[3!=t.userType?a("el-col",{staticClass:"tree_box",attrs:{span:4}},[a("div",[a("el-input",{staticClass:"filter_text",attrs:{placeholder:"输入关键字进行过滤"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),a("el-tree",{ref:"tree",attrs:{data:t.Treedata,props:t.defaultProps,"render-content":t.renderContent,"highlight-current":"","filter-node-method":t.filterNode},on:{"node-click":t.handleNodeClick}})],1)]):t._e(),t._v(" "),a("el-col",{staticStyle:{height:"100%"},attrs:{span:3==t.userType?24:20}},[a("div",{staticClass:"top"},[a("div",[t._v("\r\n                   部门/部位："),a("el-input",{model:{value:t.department,callback:function(e){t.department=e},expression:"department"}}),t._v(" \r\n                时间筛选："),a("el-date-picker",{staticClass:"picker",attrs:{type:"date",placeholder:"开始日期","picker-options":t.expireTimeOptionStart},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v(" -\r\n                "),a("el-date-picker",{staticClass:"picker",attrs:{type:"date","picker-options":t.expireTimeOptionEnd,placeholder:"结束日期"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.seach}},[t._v(" 查询")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.exportPolling}},[t._v("导出")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleReset}},[t._v("重置")])],1)]),t._v(" "),a("div",{staticStyle:{"margin-top":"10px",height:"88%",position:"relative"}},[a("el-table",{staticStyle:{width:"150"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"checkDepartment",label:"被检查部门或部位",width:"280"}}),t._v(" "),a("el-table-column",{attrs:{prop:"checkPerson",label:"参加检查人员",width:"320"}}),t._v(" "),a("el-table-column",{attrs:{prop:"maintenanceType",label:"维保方式",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(1==e.row.maintenanceType?"自我维保":"第三方维保"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"提交时间",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.date))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"详情"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.editData(e.row)}}},[t._v("查看")])]}}])})],1),t._v(" "),a("div",{staticClass:"page",staticStyle:{position:"absolute",bottom:"0"}},[a("pagination",{ref:"paginations",attrs:{total:t.total},on:{pageChange:t.pageChange}})],1)],1)])],1),t._v(" "),a("el-dialog",{attrs:{width:"475px",title:"巡检任务详情",visible:t.pollingVisible1,id:"pollings"},on:{"update:visible":function(e){t.pollingVisible1=e}}},[t.maintenance.maintenanceImgUrl?a("div",{staticClass:"checkImage"},[a("div",{staticClass:"title1"},[t._v("\r\n                    维保照片\r\n                ")]),t._v(" "),a("div",{staticClass:"imageList"},t._l(t.maintenance.maintenanceImgUrl,function(e,i){return a("el-image",{key:i,staticClass:"img",staticStyle:{width:"100px",height:"100px"},attrs:{src:e,"preview-src-list":t.maintenance.maintenanceImgUrl}})}),1)]):t._e()]),t._v(" "),a("el-dialog",{attrs:{width:"475px",title:"巡检任务详情",visible:t.pollingVisible,id:"polling"},on:{"update:visible":function(e){t.pollingVisible=e}}},[a("div",{staticClass:"content"},[a("div",{staticClass:"taskName"},[a("div",[t._v("被检查部门或部位")]),t._v(" "),a("div",[t._v(t._s(t.pollingDetail.department))])]),t._v(" "),a("div",{staticClass:"taskName"},[a("div",[t._v("检查时间")]),t._v(" "),a("div",[t._v(t._s(t._f("timeFormat")(t.pollingDetail.endTimeValue)))])]),t._v(" "),a("div",{staticClass:"taskName"},[a("div",[t._v("参加检查人员")]),t._v(" "),a("div",t._l(t.pollingDetail.checkPeople,function(e,i){return a("span",{key:i},[t._v(t._s(e)+"、")])}),0)]),t._v(" "),t._l(t.pollingDetail.list,function(e,i){return 1==e.status?[a("div",{staticClass:"taskName"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"line"}),t._v(" "),0==e.type?[t._v("火灾隐患整改及防范措施落实情况")]:t._e(),t._v(" "),1==e.type?[t._v("安全疏散通道疏散标志、应急照明和安全出口情况")]:t._e(),t._v(" "),2==e.type?[t._v("消防车道、消防水源情况")]:t._e(),t._v(" "),3==e.type?[t._v("用火、用电有无违章情况")]:t._e(),t._v(" "),4==e.type?[t._v("灭火器配置及有效情况")]:t._e(),t._v(" "),5==e.type?[t._v("抽查重点工种人员以及其他员工消防知识掌握情况")]:t._e(),t._v(" "),6==e.type?[t._v("消防安全重点部位管理情况")]:t._e(),t._v(" "),7==e.type?[t._v("危险品和场所防火防爆落实情况以及重要物资防火安全情况")]:t._e(),t._v(" "),8==e.type?[t._v("消控室值班和设施运行、记录情况（抽查系统）")]:t._e(),t._v(" "),9==e.type?[t._v("防火巡查情况（查记录表、电脑等）")]:t._e(),t._v(" "),10==e.type?[t._v("消防安全标志的设置情况和完好、有效情况")]:t._e(),t._v(" "),11==e.type?[t._v("其他情况")]:t._e()],2)]),t._v(" "),a("div",{staticClass:"taskName"},[a("div",[t._v("是否存在违章情况")]),t._v(" "),a("div",[a("el-radio-group",{model:{value:e.status1,callback:function(a){t.$set(e,"status1",a)},expression:"item.status1"}},[a("el-radio",{attrs:{label:1}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("否")])],1)],1)]),t._v(" "),1==e.status1?a("div",[a("div",{staticClass:"title"},[t._v("巡检记录")]),t._v(" "),a("div",{staticClass:"descript"},[a("div",{staticClass:"title1"},[t._v("检查情况")]),t._v(" "),a("div",{staticClass:"textarea"},[t._v("\r\n                                    "+t._s(e.content)+"\r\n                                ")])]),t._v(" "),e.checkImg.length?a("div",{staticClass:"checkImage"},[a("div",{staticClass:"title1"},[t._v("\r\n                                    巡查照片\r\n                                ")]),t._v(" "),a("div",{staticClass:"imageList"},t._l(e.checkImg,function(t,e){return a("img",{key:e,staticClass:"img",attrs:{src:t,alt:""}})}),0)]):t._e()]):t._e()]:t._e()}),t._v(" "),a("div",{staticClass:"descript"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"line"}),t._v(" 处理情况\r\n                    ")]),t._v(" "),a("div",{staticClass:"textarea"},[t._v("\r\n                        "+t._s(t.pollingDetail.content)+"\r\n                    ")])]),t._v(" "),a("div",{staticClass:"sign_head"},[t._v("\r\n                    签名\r\n                ")]),t._v(" "),a("div",{staticClass:"sign"},[a("img",{attrs:{src:t.pollingDetail.watchkeeperImgUrl,alt:""}})])],2)])],1)},staticRenderFns:[]};var r=a("VU/8")(n,l,!1,function(t){a("8Z6j")},null,null);e.default=r.exports}});